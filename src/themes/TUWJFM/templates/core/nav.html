{% load static from staticfiles %}
{% load svg from press_url %}
{% load roles %}
{% load i18n %}
{% load hooks %}
{% load subnav %}

{% if request.journal.code == "JFM" or request.journal.code == "JFMT" %}
<div class="container-fluid d-none d-xl-block tuw-header">
    <div class="d-flex flex-row justify-content-between align-items-start flex-wrap">
        <div class="align-self-end">
            <a href="http://www.ifm.tuwien.ac.at"> <img src="{% static "TUWJFM/img/jfm_logo_150x62.png" %}" alt="IFM - Real Estate and Facility Management"></a>
        </div>
        <div>
            <a href="{% url 'website_index' %}"><img style="padding: 12px;" src="{% static "TUWJFM/img/jfm_title_847x100.png" %}" alt="Journal for Facility Management"></a>
        </div> 
        <div class="align-self-end">
            <a href="https://tuwien.ac.at/bibliothek"><img src="{% static "TUWJFM/img/tuw_bib_logo_277x62.png" %}" alt="TU Wien Bibliothek"></a>
        </div>
    </div>
</div>

<div class="container-fluid d-xl-none tuw-header ">
    <div class="d-flex flex-row">
        <div class="col-12 text-center">
            <a href="{% url 'website_index' %}"><img class="img-fluid" src="{% static "TUWJFM/img/jfm_title_847x100.png" %}" alt="IFM - Real Estate and Facility Management"></a>
        </div>
    </div>
    <div class="d-flex flex-row flex-wrap">
        <div class="col-6 text-center">
            <div class="align-self-end">
                <a href="http://www.ifm.tuwien.ac.at"> <img class="img-fluid" src="{% static "TUWJFM/img/jfm_logo_150x62.png" %}" alt="Journal for Facility Management"></a>
            </div>
        </div>
        <div class="col-6 text-center">
            <div class="align-self-end">
                <a href="https://tuwien.ac.at/bibliothek"><img class="img-fluid" src="{% static "TUWJFM/img/tuw_bib_logo_277x62.png" %}" alt="TU Wien Bibliothek"></a>
            </div>
        </div>
    </div>
</div>
{% endif %}


{% if request.journal.code == "OES" or request.journal.code == "OEST" %}
<div class="container-fluid d-none d-xl-block tuw-header">
    <div class="d-flex flex-row justify-content-between align-items-start flex-wrap">
        <div class="align-self-end">
            <a href="http://www.ifip.tuwien.ac.at"> <img src="{% static "TUWJFM/img/oes_logo_175x62.png" %}" alt="Forschungsbereich Finanzwissenschaft und Infrastrukturpolitik"></a>
        </div>
        <div>
            <a href="{% url 'website_index' %}"><img style="padding: 12px;" src="{% static "TUWJFM/img/oes_title_676x100.png" %}" alt="The Public Sector"></a>
        </div> 
        <div class="align-self-end">
            <a href="https://tuwien.ac.at/bibliothek"><img src="{% static "TUWJFM/img/tuw_bib_logo_277x62.png" %}" alt="TU Wien Bibliothek"></a>
        </div>
    </div>
</div>

<div class="container-fluid d-xl-none tuw-header ">
    <div class="d-flex flex-row">
        <div class="col-12 text-center">
            <a href="{% url 'website_index' %}"><img src="{% static "TUWJFM/img/oes_title_676x100.png" %}" alt="The Public Sector"></a>
        </div>
    </div>
    <div class="d-flex flex-row flex-wrap">
        <div class="col-6 text-center">
            <div class="align-self-end">
                <a href="http://www.ifip.tuwien.ac.at"> <img src="{% static "TUWJFM/img/oes_logo_175x62.png" %}" alt="Forschungsbereich Finanzwissenschaft und Infrastrukturpolitik"></a>
            </div>
        </div>
        <div class="col-6 text-center">
            <div class="align-self-end">
                <a href="https://tuwien.ac.at/bibliothek"><img src="{% static "TUWJFM/img/tuw_bib_logo_277x62.png" %}" alt="TU Wien Bibliothek"></a>
            </div>
        </div>
    </div>
</div>
{% endif %}

  

    <div class="container-fluid" style="padding-left: 0px; padding-right: 0px;">
        <nav class="navbar navbar-expand navbar-toggleable-md navbar-light">

        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
    
        <div class="navigation collapse navbar-collapse tuw-navtop align-items-center" id="navbarSupportedContent">
            <ul class="navbar-nav mx-auto">
                {% if request.journal.nav_home %}
                <li class="nav-item"><a href="{% url 'website_index' %}" class="nav-link">
                    {% if request.journal.code == "JFM" or request.journal.code == "JFMT" %}                
                        Journal for Facility Managment
                    {% elif request.journal.code == "OES" or request.journal.code == "OEST" %}
                        {% if LANGUAGE_CODE == "de" %}                
                            Der Öffentliche Sektor
                        {% else %}
                            The Public Sector
                        {% endif %}
                    {% else %}
                        Home
                    {% endif %}
                </a></li>
                {% endif %}

                {% for item in navigation_items %}
                {% if item.has_sub_nav %}
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="" id="{{ item.link_name|slugify }}"
                        data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            {{ item.link_name }}
                        </a>
                        <div class="dropdown-menu" aria-labelledby="{{ item.link_name|slugify }}">
                            {% tag_get_sub_nav_items item LANGUAGE_CODE as sub_nav_items %}
                            {% for subnav in sub_nav_items %}
                            <a href="{{ subnav.url }}" class="dropdown-item">{{ subnav.link_name }}</a>
                            {% endfor %}
                            {% if request.journal.code == "OES" or request.journal.code == "OEST" %}
                            {% if LANGUAGE_CODE == "de" and item.link_name == "Über diese Zeitschrift" %}
                                <a href="{% url 'newsletter' %}" class="dropdown-item">{% trans "Newsletter" %}</a>
                            {% elif LANGUAGE_CODE == "en" and item.link_name == "About" %}
                                <a href="{% url 'newsletter' %}" class="dropdown-item">{% trans "Newsletter" %}</a>
                            {% else %}
                            {% endif %}
                            {% endif %}
                        </div>
                    </li>
                {% else %}
                    <li class="nav-item"><a href="{{ item.url }}" class="nav-link">{{ item.link_name }}</a></li>
                {% endif %}
                {% endfor %}
              
                {% if request.journal.nav_news %}
                    <li class="nav-item"><a href="{% url 'core_news_list' %}" class="nav-link">{% trans "News" %}</a></li>{% endif %}
    
                {% if request.journal.nav_articles %}
                    <li class="nav-item"><a href="{% url 'journal_articles' %}" class="nav-link">{% trans "Articles" %}</a>
                    </li>{% endif %}
                {% if request.journal.nav_issues %}
                    {% if request.journal.code == "JFM" or request.journal.code == "JFMT" %} 
                        <li class="nav-item"><a href="{% url 'journal_issues' %}" class="nav-link">{% trans "Issues" %}</a></li>
                    {% elif request.journal.code == "OES" or request.journal.code == "OEST" %}
                        <li class="nav-item"><a href="{% url 'journal_issues' %}" class="nav-link">{% trans "Issues" context "fe_oes" %}</a></li>
                    {% else %}
                    {% endif %}
                {% endif %}

    
                {% if journal_settings.general.enable_editorial_display %}
                    {% if journal_settings.general.multi_page_editorial %}
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="" id="editorial_team"
                        data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            Editorial Team
                        </a>
                        <div class="dropdown-menu" aria-labelledby="editorial_team">
                            {% for group in request.journal.editorial_groups %}
                                <a href="{% url 'editorial_team_group' group.pk %}" class="dropdown-item">{{ group.name }}</a>
                            {% endfor %}
                        </div>
                    </li>
                    {% else %}
                    <li class="nav-item"><a href="{% url 'editorial_team' %}" class="nav-link">Editorial Team</a>
                    </li>
                    {% endif %}
                {% endif %}
    
                {% if request.journal.nav_sub %}
                    <li class="nav-item"><a href="{% url 'journal_submissions' %}" class="nav-link">Submission</a>
                    </li>
                {% endif %}
                
<!--
                {% if request.journal.nav_contact %}
                    <li class="nav-item"><a href="{% url 'contact' %}" class="nav-link">Contact</a></li>{% endif %}
-->
                {% hook 'nav_block' %}
                {% if request.journal.nav_start and not journal_settings.general.disable_journal_submission %}
                    <li class="nav-item"><a href="{% url 'submission_start' %}" class="nav-link"><i
                            class="fa fa-cloud-upload"></i> Start
                        Submission</a></li>{% endif %}
                {% if request.journal.nav_review %}
                    <li class="nav-item"><a href="{% url 'become_reviewer' %}" class="nav-link"><i class="fa fa-trophy"></i>
                        Become a Reviewer</a>
                    </li>{% endif %}
                {% if request.user.is_authenticated %}
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="" id="user"
                        data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            Account
                        </a>
                        <div class="dropdown-menu" aria-labelledby="user">
                            <a class="dropdown-item" href="{% url 'core_dashboard' %}">Dashboard</a>
                            {% if not journal_settings.general.disable_journal_submission %}<a class="dropdown-item" href="{% url 'submission_start' %}">Submit</a>{% endif %}
                            {% user_has_role request 'editor' as user_is_editor %}
                            {% if user_is_editor or request.user.is_staff %}
                                <a class="dropdown-item" href="{% url 'kanban' %}">Kanban</a>
                                <a class="dropdown-item" href="{% url 'core_manager_index' %}">Manager</a>
                                {% if request.resolver_match.url_name and request.resolver_match.url_name == 'article_view' and article %}
                                    <a class="dropdown-item" href="{% url 'manage_archive_article' article.pk %}">Edit
                                        Article</a>
                                {% endif %}
                            {% endif %}
                            {% if request.user.is_staff %}
                                <a class="dropdown-item" href="/admin/">Admin</a>
                            {% endif %}
                            <a class="dropdown-item" href="{% url 'core_edit_profile' %}">Profile</a>
                            <a class="dropdown-item" href="{% url 'core_logout' %}">Logout</a>
                        </div>
                    </li>
                {% else %}
                    <li class="nav-item"><a href="{% url 'core_login' %}" class="nav-link"><i class="fa fa-sign-in">
                        &nbsp;</i>Login</a></li>
<!--                    <li class="nav-item"><a href="{% url 'core_register' %}" class="nav-link"><i class="fa fa-user-plus">
                        &nbsp;</i>Register</a></li>-->
                {% endif %}


            <li class="nav-item">
            <form method="POST" action="{% url 'search' %}" class="form-inline mt-2 mt-md-0">
                    {% csrf_token %}
                    <input id="searchField" class="form-control mr-sm-2" type="text" placeholder='{% trans "Search" %}'' name="article_search">
                    <input type="hidden" name="sort" value="title">
                    <button id="searchBtn" class="btn my-2 my-sm-0" type="submit">{% trans "Search" %}</button>
            </form>            
            </li>
            {% if journal_settings.general.switch_language %}
            <li class="nav-item">
                    <form class="form-inline mt-2 mt-md-0" action="{% url 'set_language' %}" method="post">{% csrf_token %}
                    <input name="next" type="hidden" value="{{ request.PATH }}"/>
                    <select name="language" onchange="this.form.submit()">
                        {% get_current_language as LANGUAGE_CODE %}
                        {% get_available_languages as LANGUAGES %}
                        {% get_language_info_list for LANGUAGES as languages %}
                        {% for language in languages %}
                            <option value="{{ language.code }}"{% if language.code == LANGUAGE_CODE %}
                                    selected{% endif %}>
                                {{ language.name_local }} ({{ language.code }})
                            </option>
                        {% endfor %}
                    </select>
                </form>
            </li>

            {% endif %}
            </ul>


        </div>
    </nav>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.js"></script>
<script type="text/javascript">
$(document).ready(function(){
    $('#searchBtn').prop('disabled',true);
    var length=$(this).val().length;
    if (length<3 || length>100)
            $('#searchBtn').prop('disabled',true);            
        else
            $('#searchBtn').prop('disabled',false);

    $('#searchField').keyup(function()
    {
        var length=$(this).val().length;
        if (length<3 || length>100)
            $('#searchBtn').prop('disabled',true);            
        else
            $('#searchBtn').prop('disabled',false);
    })
});
</script>






